import*as e from"https://cdnjs.cloudflare.com/ajax/libs/three.js/0.156.1/three.module.min.js";import{GLTFLoader as t}from"https://cdn.jsdelivr.net/gh/Leandro201927/LeaInnova_CDN@master/threejs/loaders/GLTFLoader.js";import{DRACOLoader as n}from"https://cdn.jsdelivr.net/gh/Leandro201927/LeaInnova_CDN@master/threejs/loaders/DRACOLoader.js";import{EffectComposer as o}from"https://cdn.jsdelivr.net/gh/Leandro201927/LeaInnova_CDN@master/threejs/postprocessing/EffectComposer.js";import{RenderPass as i}from"https://cdn.jsdelivr.net/gh/Leandro201927/LeaInnova_CDN@master/threejs/postprocessing/RenderPass.js";import{UnrealBloomPass as a}from"https://cdn.jsdelivr.net/gh/Leandro201927/LeaInnova_CDN@master/threejs/postprocessing/UnrealBloomPass.js";import{ShaderPass as r}from"https://cdn.jsdelivr.net/gh/Leandro201927/LeaInnova_CDN@master/threejs/postprocessing/ShaderPass.js";import{GammaCorrectionShader as s}from"https://cdn.jsdelivr.net/gh/Leandro201927/LeaInnova_CDN@master/threejs/shaders/GammaCorrectionShader.js";import{RGBShiftShader as c}from"https://cdn.jsdelivr.net/gh/Leandro201927/LeaInnova_CDN@master/threejs/shaders/RGBShiftShader.js";import{FXAAShader as l}from"https://cdn.jsdelivr.net/gh/Leandro201927/LeaInnova_CDN@master/threejs/shaders/FXAAShader.js";import{RoomEnvironment as m}from"https://cdn.jsdelivr.net/gh/Leandro201927/LeaInnova_CDN@master/threejs/environments/RoomEnvironment.js";import*as d from"https://cdnjs.cloudflare.com/ajax/libs/tween.js/21.0.0/tween.esm.min.js";registerComponent((async()=>{const u=new URL(import.meta.url),p=new URLSearchParams(u.search),h=p.get("key"),g=p.get("templateUrl");p.get("componentName");const w=document.getElementById(h),f=w.querySelector(".background-gradient-mobile"),v=w.querySelector(".slider-container"),y=w.querySelector(".slide-1"),S=w.querySelector(".slide-2 .slider-image-supercontainer");new AccordionController(y);const C=new SliderController(v),L=new SliderImageController(S),x=new e.Clock,b=new e.Vector3;let M=1;function A(){return window.innerWidth>1366?"desktopL":window.innerWidth<=1366&&window.innerWidth>1024?"desktopM":window.innerWidth<=1024&&window.innerWidth>768?"desktopS":window.innerWidth<=768&&window.innerWidth>425?"tablet":"mobile"}let j,E=A(),P=1;const z={desktopL:{position:{x:9.89600658416748,y:13.16525993347168,z:13.140523910522461},frustrumSizeCamera:6},desktopM:{position:{x:9.89600658416748,y:13.41525993347168,z:13.640523910522461},frustrumSizeCamera:5.5},desktopS:{position:{x:13.39600658416748,y:12.66525993347168,z:13.640523910522461},frustrumSizeCamera:10},tablet:{position:{x:13.89600658416748,y:12.66525993347168,z:13.640523910522461},frustrumSizeCamera:10},mobile:{position:{x:13.89600658416748,y:12.66525993347168,z:13.640523910522461},frustrumSizeCamera:10}};let T;const R={desktopL:{position:{x:5.167432249854422,y:9,z:13.312374668985601},lookAt:{x:-4.5,y:-.5,z:0},frustrumSizeCamera:2},desktopM:{position:{x:5.167432249854422,y:9,z:13.312374668985601},lookAt:{x:-4.5,y:-.5,z:0},frustrumSizeCamera:2},desktopS:{position:{x:5.167432249854422,y:9,z:13.312374668985601},lookAt:{x:-3.5,y:-1.5,z:0},frustrumSizeCamera:3},tablet:{position:{x:5.167432249854422,y:9,z:13.312374668985601},lookAt:{x:-3.5,y:-1.5,z:0},frustrumSizeCamera:3},mobile:{position:{x:5.167432249854422,y:9,z:13.312374668985601},lookAt:{x:-3.5,y:-1.15,z:0},frustrumSizeCamera:2.5}},I=w.querySelector("canvas#webgl1"),W=w.querySelector("canvas#webgl2");let _=0;C.on("onslidechange",(function(e){if(0===e&&1===_){const t=()=>{I.style.opacity=1,P=1,W.removeEventListener("transitionend",t)};W.addEventListener("transitionend",t);let n={value:z[E].frustrumSizeCamera+1.5},o={value:z[E].frustrumSizeCamera};new d.Tween(n).to(o,1e3).easing(d.Easing.Quadratic.InOut).onUpdate((function(){const e=n.value/2,t=I.clientWidth/I.clientHeight;j.left=-e*t,j.right=e*t,j.top=e,j.bottom=-e,j.updateProjectionMatrix()})).start();let i={value:R[E].frustrumSizeCamera},a={value:R[E].frustrumSizeCamera+.5};new d.Tween(i).to(a,1e3).easing(d.Easing.Quadratic.InOut).onUpdate((function(){const e=i.value/2,t=I.clientWidth/I.clientHeight;T.left=-e*t,T.right=e*t,T.top=e,T.bottom=-e,T.updateProjectionMatrix()})).start(),W.style.opacity=0,_=e}if(1===e){if(0===_){const e=()=>{W.style.opacity=1,P=2,I.removeEventListener("transitionend",e)};I.addEventListener("transitionend",e);let t={value:z[E].frustrumSizeCamera},n={value:z[E].frustrumSizeCamera+1.5};new d.Tween(t).to(n,1e3).easing(d.Easing.Quadratic.InOut).onUpdate((function(){const e=t.value/2,n=I.clientWidth/I.clientHeight;j.left=-e*n,j.right=e*n,j.top=e,j.bottom=-e,j.updateProjectionMatrix()})).start();let o={value:R[E].frustrumSizeCamera+.5},i={value:R[E].frustrumSizeCamera};new d.Tween(o).to(i,1e3).easing(d.Easing.Quadratic.InOut).onUpdate((function(){const e=o.value/2,t=I.clientWidth/I.clientHeight;T.left=-e*t,T.right=e*t,T.top=e,T.bottom=-e,T.updateProjectionMatrix()})).start(),I.style.opacity=0}else if(2===_){if($("close"),"desktopS"!==E&&"tablet"!==E&&"mobile"!==E){const e={value:R[E].frustrumSizeCamera-.5},t={value:R[E].frustrumSizeCamera};new d.Tween(e).to(t,1e3).easing(d.Easing.Quadratic.InOut).onUpdate((function(){const t=e.value/2,n=I.clientWidth/I.clientHeight;T.left=-t*n,T.right=t*n,T.top=t,T.bottom=-t,T.updateProjectionMatrix()})).start()}new d.Tween(b).to({y:R[E].lookAt.y},1e3).easing(d.Easing.Quadratic.InOut).onUpdate((function(){})).start()}_=e}if(2===e){if($("open",k),"desktopS"!==E&&"tablet"!==E&&"mobile"!==E){const e={value:R[E].frustrumSizeCamera},t={value:R[E].frustrumSizeCamera-.5};new d.Tween(e).to(t,1e3).easing(d.Easing.Quadratic.InOut).onUpdate((function(){const t=e.value/2,n=I.clientWidth/I.clientHeight;T.left=-t*n,T.right=t*n,T.top=t,T.bottom=-t,T.updateProjectionMatrix()})).start()}"desktopS"!==E&&"tablet"!==E&&"mobile"!==E||new d.Tween(b).to({y:b.y+.5},1e3).easing(d.Easing.Quadratic.InOut).onUpdate((function(){})).start(),_=e}}));let k="movier";L.on("preslidechange",(e=>{Z();const t=S.querySelector(`.slider-image-container-${e}`);console.log(e,t.classList),t.classList.contains("movier")?k="movier":t.classList.contains("cproc")&&(k="cproc"),console.log(k)})),L.on("slidechange",(e=>{X(k)}));const O={width:W.clientWidth,height:W.clientHeight},B=new e.WebGLRenderer({canvas:I,antialias:!0,alpha:!0});B.setSize(O.width,O.height),B.setPixelRatio(window.devicePixelRatio),B.outputColorSpace=e.SRGBColorSpace,B.physicallyCorrectLights=!0,B.toneMapping=e.LinearToneMapping,B.toneMappingExposure=1.04,B.setSize(O.width,O.height),B.setPixelRatio(window.devicePixelRatio);const U=new e.PMREMGenerator(B),F=new e.TextureLoader,H=new n;H.setDecoderPath(`${g}/js/lib/draco/`);const D=new t;D.setDRACOLoader(H);const N=(t,n=!1)=>new Promise(((o,i)=>{(new e.TextureLoader).load(t,(t=>{t.flipY=n,t.colorSpace=e.SRGBColorSpace,o(t)}),void 0,(e=>i(e)))})),Q=()=>{M+=1;let e=Math.round(M/6*100);loaderHandler.updateProgress(e)};let V,q;const{RAF_2:G,preLoadResources:Y,enable3rdSectionAnimations:$,projectImgOrVideoInLaptopScreen:X,shutDownLaptopScreen:Z}=function(){let t,n,m,u,p,h,w,f,v,y={},S=["ScreenPlateAction","ScreenAction.001","ALogoAction"],C=!0;const M=new e.MeshPhongMaterial({emissive:65423,emissiveIntensity:1.8,transparent:!0,opacity:0}),j=new e.Scene;function P(e){w&&(e?(w.visible=!1,C=!1):(w.visible=!0,C=!0))}function z(t){if(!t)return;let n;if("movier"===t){const t=document.createElement("video");t.src=`${g}/assets/3d/homepage/movier.mp4`,t.crossOrigin="anonymous",t.play(),t.muted=!0,v=t,n=new e.VideoTexture(t),P(!1)}else{const t=document.getElementById("cproc-img");v=t,n=(new e.TextureLoader).load(t.src),P(!0)}n.minFilter=e.LinearFilter,n.magFilter=e.LinearFilter,n.flipY=!1,e.ShaderLib.customVideoShader={uniforms:{tDiffuse:{type:"t",value:null},brightness:{type:"f",value:0},contrast:{type:"f",value:0}},vertexShader:"\n          varying vec2 vUv;\n          void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          }\n        ",fragmentShader:"\n          uniform sampler2D tDiffuse;\n          uniform float brightness;\n          uniform float contrast;\n          varying vec2 vUv;\n          void main() {\n            vec4 color = texture2D(tDiffuse, vUv);\n            color.rgb += brightness;\n            if (contrast > 0.0) {\n              color.rgb = (color.rgb - 0.5) / (1.0 - contrast) + 0.5;\n            } else {\n              color.rgb = (color.rgb - 0.5) * (1.0 + contrast) + 0.5;\n            }\n            gl_FragColor = color;\n          }\n        "};const o=new e.ShaderMaterial({uniforms:e.UniformsUtils.clone(e.ShaderLib.customVideoShader.uniforms),vertexShader:e.ShaderLib.customVideoShader.vertexShader,fragmentShader:e.ShaderLib.customVideoShader.fragmentShader});o.uniforms.tDiffuse.value=n,o.uniforms.brightness.value=-.3,o.uniforms.contrast.value=-.4,f.material=o}const I={x:0,y:0};let k=null;window.addEventListener("mousemove",(e=>{I.x=e.clientX/window.innerWidth*2-1,I.y=-e.clientY/window.innerHeight*2+1}));const B=new e.Raycaster,U=new e.Vector2;let H=null;return window.addEventListener("mousemove",(e=>{U.x=e.clientX/window.innerWidth*2-1,U.y=-e.clientY/window.innerHeight*2+1}),!1),window.addEventListener("click",(()=>{B.setFromCamera(U,T);const e=B.intersectObjects(j.children,!0);for(let t=0;t<e.length;t++)if("RaycastHoverArrowNext"===e[t].object.name)L.nextPage(),console.log("arrownext");else if("RaycastHoverArrowPrev"===e[t].object.name)L.prevPage(),console.log("arrowprev");else if("RaycastHoverRepeat"===e[t].object.name)try{v.pause(),v.currentTime="0",v.play()}catch(e){console.warn("No es un video.")}}),!1),{RAF_2:function(){t&&(t.scene.rotation.y+=64e-5*(I.x-18*t.scene.rotation.y-0),I.y,b.y,T.lookAt(b));let e=null;B.setFromCamera(U,T);const o=B.intersectObjects(j.children,!0);for(let t=0;t<o.length;t++)if("RaycastHoverArrowPrev"===o[t].object.name||"RaycastHoverArrowNext"===o[t].object.name||"RaycastHoverRepeat"===o[t].object.name){document.body.style.cursor="pointer";switch(o[t].object.name){case"RaycastHoverArrowPrev":e=h;break;case"RaycastHoverArrowNext":e=p;break;case"RaycastHoverRepeat":C||(document.body.style.cursor="default"),e=w}break}e?H!==e&&(!H||k&&k.isPlaying()||(k=new d.Tween(H.scale).to({x:1,y:1,z:1},250).easing(d.Easing.Quadratic.Out).start()),H=e,k=new d.Tween(H.scale).to({x:1.15,y:1.15,z:1.15},250).easing(d.Easing.Quadratic.Out).start()):(document.body.style.cursor="default",!H||k&&k.isPlaying()||(k=new d.Tween(H.scale).to({x:1,y:1,z:1},500).easing(d.Easing.Quadratic.Out).onComplete((()=>{H=null})).start())),m&&m.render(),n&&n.update(x.getDelta())},preLoadResources:function(){const d=F.load(`${g}/assets/3d/homepage/laptop_4k_baked.webp`,(()=>{d.flipY=!1,d.colorSpace=e.SRGBColorSpace})),v=new e.MeshPhongMaterial({emissive:65423,emissiveIntensity:1.8});new Promise(((n,o)=>{D.load(`${g}/assets/3d/homepage/105-laptop.glb`,(o=>{t=o;let i=o.scene.children.length,a=0;o.animations&&(u=o.animations.filter((e=>S.includes(e.name)))),o.scene.traverse((t=>{if(a++,t instanceof e.Mesh){if(console.log(t.name),t.material=new e.MeshBasicMaterial({map:d}),"Plane002_1"===t.name&&(t.material=new e.MeshStandardMaterial({color:3947580,envMap:q})),"Plane002_2"===t.name&&(t.material=v),"ALogo"===t.name&&(t.material=v),"RaycastHoverArrowPrev"!==t.name&&"RaycastHoverArrowNext"!==t.name&&"RaycastHoverRepeat"!==t.name||(t.material=new e.MeshBasicMaterial({color:16777215,transparent:!0,opacity:0})),"ArrowNext"===t.name||"ArrowPrev"===t.name||"Repeat"===t.name){switch(t.name){case"ArrowNext":p=t;break;case"ArrowPrev":h=t;break;case"Repeat":w=t}t.material=M}"Screen"===t.name&&(f=t)}a===i&&n()})),j.add(o.scene)}))})).then((()=>{n=new e.AnimationMixer(t.scene),n.timeScale=2,u.forEach((t=>{let o=n.clipAction(t);o.enabled=!0,o.setLoop(e.LoopOnce),o.clampWhenFinished=!0,o.setEffectiveTimeScale(1),o.setEffectiveWeight(1),y[t.name]={action:o}}))})),window.addEventListener("resize",(function(){O.width=W.clientWidth,O.height=W.clientHeight,E=A();let t=new e.Vector3(R[E].position.x,R[E].position.y,R[E].position.z);T.position.copy(t),b.x=R[E].lookAt.x,b.y="desktopS"!==E&&"tablet"!==E&&"mobile"!==E||2!==_?R[E].lookAt.y:R[E].lookAt.y+.5,b.z=R[E].lookAt.z,T.lookAt(b.x,b.y,b.z);const n=O.width/O.height,o=R[E].frustrumSizeCamera/2,i=-o*n,a=o*n,r=o,s=-o;T.left=i,T.right=a,T.top=r,T.bottom=s,T.near=-100,T.far=1e3,T.updateProjectionMatrix(),x.setSize(O.width,O.height),m.setSize(O.width,O.height),x.setPixelRatio(window.devicePixelRatio)}));const C=O.width/O.height,L=R[E].frustrumSizeCamera/2;T=new e.OrthographicCamera(-L*C,L*C,L,-L,-100,1e3),b.x=R[E].lookAt.x,b.y=R[E].lookAt.y,b.z=R[E].lookAt.z,T.position.set(R[E].position.x,R[E].position.y,R[E].position.z),T.rotation.order="XYZ",T.rotation.set(0,0,0),T.lookAt(b.x,b.y,b.z),j.add(T);const x=new e.WebGLRenderer({canvas:W,antialias:!0});x.setSize(O.width,O.height),x.setPixelRatio(window.devicePixelRatio),x.outputColorSpace=e.SRGBColorSpace,x.physicallyCorrectLights=!0,x.toneMapping=e.LinearToneMapping,x.toneMappingExposure=1.04,m=new o(x),m.setSize(O.width,O.height),m.setPixelRatio(1);const P=new i(j,T),z=new a;z.strength=.22,z.radius=.2,z.threshold=1;const I=new r(s),k=new r(l);k.uniforms.resolution.value.set(1/O.width,1/O.height),k.material.uniforms.resolution.value.x=1/O.width,k.material.uniforms.resolution.value.y=1/O.height;const B=new r(c);B.uniforms.amount.value=.0015,B.uniforms.angle.value=0,m.addPass(P),m.addPass(z),m.addPass(I)},enable3rdSectionAnimations:function(t,o=null){if("open"===t){i=y,Object.entries(i).forEach((([e,t])=>{const n=t.action;n.reset(),n.setEffectiveTimeScale(1),n.play()})),f.material=new e.MeshBasicMaterial({color:0});const t=e=>{"ScreenAction.001"===e.action.getClip().name&&(new d.Tween(M).to({opacity:1,emissiveIntensity:1.8},250).easing(d.Easing.Quadratic.Out).start(),f&&z(o),n.removeEventListener("finished",t))};n.addEventListener("finished",t)}else"close"===t&&(!function(e){Object.entries(e).forEach((([e,t])=>{const n=t.action;let o=n.getClip().duration;n.reset(),n.time=o,n.setEffectiveTimeScale(-1),n.play()}))}(y),new d.Tween(M).to({opacity:0,emissiveIntensity:0},250).easing(d.Easing.Quadratic.Out).start(),f&&(f.material=new e.MeshBasicMaterial({color:0})));var i},projectImgOrVideoInLaptopScreen:z,shutDownLaptopScreen:function(){f.material=new e.MeshBasicMaterial({color:2632740})}}}(),{RAF_1:J}=await async function(t){let n,u;const p=new e.Scene,h=await N(`${g}/assets/3d/homepage/delivery-machine-4k-baked-ultra-compress.webp`);Q();const w=await N(`${g}/assets/3d/homepage/crate_baked.webp`);Q();const v=new e.MeshBasicMaterial({map:w}),y=new e.MeshBasicMaterial({map:h});F.load(`${g}/assets/3d/homepage/kloppenheim_02_4k.jpg`,(function(t){t.mapping=e.EquirectangularReflectionMapping,t.colorSpace=e.SRGBColorSpace,q=t,Q()})),V=U.fromScene(new m,.04).texture;const S=F.load(`${g}/assets/3d/homepage/white.png`,(t=>{h.flipY=!1,h.colorSpace=e.SRGBColorSpace,Q()})),L=new e.ShaderMaterial({uniforms:{texture1:{type:"t",value:S},texture2:{type:"t",value:h},transition:{type:"f",value:0}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:"\n        uniform sampler2D texture1;\n        uniform sampler2D texture2;\n        uniform float transition;\n        varying vec2 vUv;\n        void main() {\n          vec4 tex1 = texture2D(texture1, vUv);\n          vec4 tex2 = texture2D(texture2, vUv);\n          gl_FragColor = mix(tex1, tex2, transition);\n          gl_FragColor.a = 1.0; // Asegura que la salida no sea transparente\n        }\n      "}),b=new e.MeshPhongMaterial({emissive:65423,emissiveIntensity:0}),M=new e.MeshPhongMaterial({emissive:65423,emissiveIntensity:1,transparent:!0,opacity:0}),P=[];let T,R,W,_,k={},O={},H=["SpawnUpperConveyorBelt","SpawnLowerConveyorBelt","SpawnLTransformMachine","SpawnTransformMachine","SpawnALogo","SpawnALogoContainer","SpawnTuNegocioCover","SpawnTuNegocio"],G={},Y=["CycleTranslateUpperConveyorBelt","CycleTranslateLowerConveyorBelt","CicleFloatingLogoContainer","CicleFloatingLogo","CicleFloatingTuNegocioCover","CicleFloatingTuNegocio"],$={},X=["CrateAction","MegaphoneAction.001","AIBotAction","WWW_InternetAction"];function Z(){let e=["MegaphoneAction.001","AIBotAction","WWW_InternetAction"],t=0;function n(){const o=i=>{"CrateAction"===i.action.getClip().name&&(u.removeEventListener("finished",o),function(){const o=i=>{const a=i.action.getClip().name;"AIBotAction"!==a&&"WWW_InternetAction"!==a&&"MegaphoneAction.001"!==a||(u.removeEventListener("finished",o),t=t+1>e.length-1?0:t+1,n())};u.addEventListener("finished",o),ce($,e[t])}())};u.addEventListener("finished",o),ce($,"CrateAction")}n()}const J=20.8,K=100,ee=28.6,te=new e.PointLight(255,1e4,100);te.position.set(J,K,ee),p.add(te);const ne=new e.Raycaster,oe=new e.Vector2,ie=new e.Vector2;let ae,re;function se(e){Object.entries(e).forEach((([e,t])=>{const n=t.action;n.reset(),n.setEffectiveTimeScale(1),n.play()}))}function ce(e,t){console.log("intentando reproducir accion",t);const n=e[t].action;n.reset(),n.setEffectiveTimeScale(1),n.play()}document.addEventListener("mousemove",(function(e){oe.x=e.clientX/window.innerWidth*2-1,oe.y=-e.clientY/window.innerHeight*2+1,ie.x=e.clientX,ie.y=e.clientY}),!1),new Promise(((t,o)=>{I.style.opacity=0,D.load(`${g}/assets/3d/homepage/delivery machine addon + animation.glb`,(o=>{n=o;let i=o.scene.children.length,a=0;if(o.animations&&(T=o.animations.filter((e=>"PenroseInitRotate"===e.name)),R=o.animations.filter((e=>H.includes(e.name))),W=o.animations.filter((e=>Y.includes(e.name))),_=o.animations.filter((e=>X.includes(e.name)))),o.cameras.length){const t=o.cameras[0];let n=new e.Vector3(z[E].position.x,z[E].position.y,z[E].position.z);console.log("camera1Positions[actualScreenSize]",z[E],E);let i=t.quaternion;j.position.copy(n),j.quaternion.copy(i)}o.scene.traverse((n=>{if(a++,n instanceof e.Mesh){n.material=y,(n.name.includes("Crate")||n.name.includes("Megaphone")||n.name.includes("AIBot")||n.name.includes("WWW_Internet"))&&(n.material=v),"TransformMachine_1"===n.name&&(ae=n),"LTransformMachine_3"===n.name&&(re=n),"TransformMachine_1"!==n.name&&"LTransformMachine_3"!==n.name||(n.material=new e.MeshStandardMaterial({color:65423,transparent:!0,opacity:.06,envMap:V,envMapIntensity:1,depthWrite:!1,side:e.FrontSide})),"WWW_Internet_3"!==n.name&&"AIBot_3"!==n.name||(n.material=new e.MeshBasicMaterial({color:0})),n.name.includes("PenroseTriangle")&&("PenroseTriangle_1"===n.name?n.material=L:n.material=b),"LowerConveyorBelt_1"!==n.name&&"UpperConveyorBelt_1"!==n.name||(n.receiveShadow=!0,n.material=new e.MeshBasicMaterial({color:3355443})),"Megaphone_2"!==n.name&&"AIBot_2"!==n.name&&"WWW_Internet_2"!==n.name||(n.material=new e.MeshPhongMaterial({emissive:65423,emissiveIntensity:1.5})),["ALogo","UpperConveyorBelt_2","LowerConveyorBelt_2","TransformMachine_2","TuNegocioText","LTransformMachine_2","Crate_2"].includes(n.name)&&(n.material=M),["Floor","AIBot","WWW_Internet","Megaphone","Crate","LowerConveyorBelt","UpperConveyorBelt"].some((e=>n.name.includes(e)))&&(n.material.transparent=!0,n.material.opacity=0,P.push(n))}a===i&&t()})),p.add(o.scene)}))})).then((()=>{Q(),t(),u=new e.AnimationMixer(n.scene),u.timeScale=1.25,T.forEach((t=>{let n=u.clipAction(t);n.enabled=!0,n.setLoop(e.LoopOnce),n.clampWhenFinished=!0,n.setEffectiveTimeScale(1),n.setEffectiveWeight(1),k[t.name]={action:n}})),R.forEach((t=>{let n=u.clipAction(t);n.enabled=!0,n.setLoop(e.LoopOnce),n.clampWhenFinished=!0,n.setEffectiveTimeScale(1),n.setEffectiveWeight(1),O[t.name]={action:n}})),W.forEach((t=>{let n=u.clipAction(t);n.enabled=!0,n.setLoop(e.LoopRepeat),n.clampWhenFinished=!0,n.setEffectiveTimeScale(1),n.setEffectiveWeight(1),G[t.name]={action:n}})),_.forEach((t=>{let n=u.clipAction(t);n.enabled=!0,n.setLoop(e.LoopOnce),n.clampWhenFinished=!0,n.setEffectiveTimeScale(1),n.setEffectiveWeight(1),$[t.name]={action:n}})),setTimeout((()=>{document.querySelector("header").style.transform="translateY(0px)",u.addEventListener("finished",(function(e){const t=e.action.getClip().name;"PenroseInitRotate"===t?(f.classList.add("show"),new d.Tween(L.uniforms.transition).to({value:1},500).easing(d.Easing.Quadratic.InOut).onComplete((()=>{})).start(),new d.Tween(b).to({emissiveIntensity:1.25},500).easing(d.Easing.Quadratic.InOut).onComplete((()=>{})).start(),P.forEach((e=>{new d.Tween(e.material).to({opacity:1},700).easing(d.Easing.Quadratic.InOut).onComplete((()=>{})).start()}))):"SpawnLTransformMachine"===t&&(se(G),C.renderFirstSlide())})),se(k),se(O);let e={value:45},t={value:z[E].frustrumSizeCamera};new d.Tween(e).to(t,1500).easing(d.Easing.Quadratic.InOut).onUpdate((function(){const t=e.value/2;j.left=-t*me,j.right=t*me,j.top=t,j.bottom=-t,j.updateProjectionMatrix()})).onComplete((function(){Z()})).start()}),1e3);const o=loaderHandler.getLoaderParentElement();new d.Tween(o.style).to({opacity:0},500).easing(d.Easing.Quadratic.InOut).onComplete((()=>{o.style.display="none",I.style.opacity=1})).start()}));const le={width:I.clientWidth,height:I.clientHeight};window.addEventListener("resize",(function(){le.width=I.clientWidth,le.height=I.clientHeight,E=A();let t=new e.Vector3(z[E].position.x,z[E].position.y,z[E].position.z);j.position.copy(t);const n=le.width/le.height,o=z[E].frustrumSizeCamera/2,i=-o*n,a=o*n,r=o,s=-o;j.left=i,j.right=a,j.top=r,j.bottom=s,j.near=-100,j.far=1e3,j.updateProjectionMatrix(),B.setSize(le.width,le.height),ue.setSize(le.width,le.height),B.setPixelRatio(window.devicePixelRatio)})),new e.Vector3;const me=I.clientWidth/I.clientHeight,de=22.5;j=new e.OrthographicCamera(-22.5*me,de*me,de,-22.5,-100,1e3),p.add(j);const ue=new o(B);ue.setPixelRatio(1);const pe=new i(p,j),he=new a;he.strength=.29,he.radius=1,he.threshold=.754;const ge=new r(s),we=new r(l);we.uniforms.resolution.value.set(1/le.width,1/le.height),we.material.uniforms.resolution.value.x=1/le.width,we.material.uniforms.resolution.value.y=1/le.height;const fe=new r(c);fe.uniforms.amount.value=.0015,fe.uniforms.angle.value=0,ue.addPass(pe),ue.addPass(he),ue.addPass(ge),ue.addPass(we);let ve,ye=!0,Se=!0;const Ce=new e.Color(65423),Le=new e.Color(11270143),xe={t:0};return new d.Tween(xe).to({t:1},0).onUpdate((function(){ae.material.color.lerpColors(Ce,Le,xe.t),re.material.color.lerpColors(Ce,Le,xe.t)})),new d.Tween(xe).to({t:0},100).onUpdate((function(){ae.material.color.lerpColors(Ce,Le,xe.t),re.material.color.lerpColors(Ce,Le,xe.t)})),{RAF_1:function(){let e=ie.y/window.innerHeight*200-100;te.position.setY(e),ve=function(){ne.setFromCamera(oe,j);const e=ne.intersectObjects(p.children);let t=!1;for(let n=0;n<e.length;n++)if("PenroseTriangle_1"===e[n].object.name||"PenroseTriangle_2"===e[n].object.name||e[n].object.name.includes("TransformMachine")||e[n].object.name.includes("LTransformMachine")){t=!0;break}return t}(),!1===ve?ye&&(ye=!1,new d.Tween(te).to({intensity:0},250).easing(d.Easing.Quadratic.InOut).onComplete((()=>{ye=!0})).start()):!0===ve&&Se&&(Se=!1,new d.Tween(te).to({intensity:1e4},250).easing(d.Easing.Quadratic.InOut).onComplete((()=>{Se=!0})).start()),ue.render(),u&&u.update(x.getDelta())}}}(Y),K=()=>{d.update(),1===P&&J?J():2===P&&G&&G(),window.requestAnimationFrame(K)};K()}));
